<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="The machine i downloaded and install are from NetSecFocus Trophy Room, under the vulnhub section. I will install the machine highligted in the red section into my proxmox.
I only manage to install 32 machines out of 38 into the proxmox.
6 Machines that i didn&amp;rsquo;t installed due to:
 Healthcare - (Too old for it to work, maybe?) Photography - (File too big for unknown reason : 500GB) GlasgowSmile - (Cannot boot, lead to grub rescue) Breach 3 - (Got IP in Proxmox but appear offline) LordoftheRoot - (Got IP in Proxmox but appear offline) Alpha 1 - (Link Broken)  Download Vulnerable Machine from Vulnhub First, lets download 1 machine from vulnhub."><meta name=keywords content=",Tutorial"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://fspxnky.github.io/settingupvulnlab/><title>Setting up Vuln Lab in Proxmox :: fspxnky â€” Security Blog</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Setting up Vuln Lab in Proxmox"><meta itemprop=description content="The machine i downloaded and install are from NetSecFocus Trophy Room, under the vulnhub section. I will install the machine highligted in the red section into my proxmox.
I only manage to install 32 machines out of 38 into the proxmox.
6 Machines that i didn&rsquo;t installed due to:
 Healthcare - (Too old for it to work, maybe?) Photography - (File too big for unknown reason : 500GB) GlasgowSmile - (Cannot boot, lead to grub rescue) Breach 3 - (Got IP in Proxmox but appear offline) LordoftheRoot - (Got IP in Proxmox but appear offline) Alpha 1 - (Link Broken)  Download Vulnerable Machine from Vulnhub First, lets download 1 machine from vulnhub."><meta itemprop=datePublished content="2022-03-28T22:11:55+08:00"><meta itemprop=dateModified content="2022-03-28T22:11:55+08:00"><meta itemprop=wordCount content="934"><meta itemprop=keywords content="Tutorial,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Setting up Vuln Lab in Proxmox"><meta name=twitter:description content="The machine i downloaded and install are from NetSecFocus Trophy Room, under the vulnhub section. I will install the machine highligted in the red section into my proxmox.
I only manage to install 32 machines out of 38 into the proxmox.
6 Machines that i didn&rsquo;t installed due to:
 Healthcare - (Too old for it to work, maybe?) Photography - (File too big for unknown reason : 500GB) GlasgowSmile - (Cannot boot, lead to grub rescue) Breach 3 - (Got IP in Proxmox but appear offline) LordoftheRoot - (Got IP in Proxmox but appear offline) Alpha 1 - (Link Broken)  Download Vulnerable Machine from Vulnhub First, lets download 1 machine from vulnhub."><meta property="article:published_time" content="2022-03-28 22:11:55 +0800 +0800"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>/home/fspxnky</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/tags>Tags</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><a href=https://fspxnky.github.io/settingupvulnlab/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>cat ./Setting up Vuln Lab in Proxmox.md</span>
<span class=logo__cursor></span></div></a><p>Reading Time: 4 minutes and 14 seconds.</p><h2 class=post-title>Setting up Vuln Lab in Proxmox</h2><div class=post-content><p>The machine i downloaded and install are from NetSecFocus Trophy <a href=https://docs.google.com/spreadsheets/u/1/d/1dwSMIAPIam0PuRBkCiDI88pU3yzrqqHkDtBngUHNCw8/htmlview#>Room</a>, under the vulnhub section. I will install the machine highligted in the red section into my proxmox.</p><p>I only manage to install 32 machines out of 38 into the proxmox.</p><p>6 Machines that i didn&rsquo;t installed due to:</p><ul><li>Healthcare - (Too old for it to work, maybe?)</li><li>Photography - (File too big for unknown reason : 500GB)</li><li>GlasgowSmile - (Cannot boot, lead to grub rescue)</li><li>Breach 3 - (Got IP in Proxmox but appear offline)</li><li>LordoftheRoot - (Got IP in Proxmox but appear offline)</li><li>Alpha 1 - (Link Broken)</li></ul><h3 id=download-vulnerable-machine-from-vulnhub>Download Vulnerable Machine from Vulnhub</h3><p>First, lets download 1 machine from vulnhub. Take note that there&rsquo;s 2 ways to download the file (Torrent or Browser). I will be using torrent because not all file can be downloaded directly from the browser.</p><p>After we are done with downloading, inspect the file. Look for .vmdk file. We are only interested in that file. If we only see .ova file, then proceed with the next step.</p><h3 id=ova-to-vmdk>.ova to .vmdk</h3><p>We need to convert the .ova file to .vmdk file. To do this, we simply need to extract the file inside .ova. There&rsquo;s a few way to do this. This is also doable using <code>winrar</code> for windows, just extract the .ova file. For linux, simply use the <code>tar</code> command in linux to extract it.</p><pre tabindex=0><code># Using oscp.ova downloaded from the vulnhub for this example
root@Karma:/tmp# tar -xvf oscp.ova
oscp.ovf
oscp.mf
oscp-file1.flp
oscp-disk1.vmdk
oscp-file2.iso
</code></pre><blockquote><p>We will get extra files when extracting the .ova file. Just delete the other file, we only need .vmdk.</p></blockquote><p>Now that we have extracted the .vmdk file from .ova, we can now send this to the our proxmox.</p><h3 id=vmdk-file-to-proxmox>.vmdk file to proxmox</h3><p>Since im using windows, i will transfer the .vmdk file to proxmox using <code>WinSCP</code>.</p><p>Just connect to proxmox server by specifying the IP address and credentials in the <code>WinSCP</code>. Transfer the .vmdk file from wherever you store it, to the /tmp folder of the proxmox.</p><p>I believe you can also transfer the file through the <code>scp</code> command in linux. More info can be found <a href=https://linuxize.com/post/how-to-use-scp-command-to-securely-transfer-files/>here.</a></p><h3 id=create-a-vm-template-in-proxmox>Create a VM Template in Proxmox</h3><p>Inside the Proxmox GUI, right click on our node and create VM. The settings is as follows:</p><ul><li>General > Name = Vulnhub Template</li><li>OS = Do not use any media</li><li>System = Just click next</li><li>Disks = No disks</li><li>CPU = Just click next</li><li>Memory = 1024</li><li>Network = Just click next</li><li>Confirm = Click finish</li></ul><p>Now, we click on the VM that we just created. Click on the &ldquo;More&rdquo; box which located on the right side of the GUI. Click on it, select &ldquo;Convert to Template&rdquo; and Click &ldquo;Yes&rdquo; to confirm.</p><p>We should now see this VM inside our nodes:</p><img src=/Vulnhub-Tutorial/Template.png class=center style=border-radius:8px><h3 id=creating-a-vm-from-the-template-and-importing-the-vmdk-file>Creating a VM from the Template and Importing the .vmdk file</h3><p>Now that we have a template ready, we can now create a VM and give that VM the .vmdk file for it to boot.</p><p>Right click on the VM Template and click on &ldquo;Clone&rdquo;. Change the Mode to &ldquo;Full Clone&rdquo; and give it a name for that VM.</p><blockquote><p>Usually i will give the VM name according to the file i download from vulnhub.</p></blockquote><p>Upon creating the VM, it will appear in the node. Please take note that the VM ID will be different.</p><img src=/Vulnhub-Tutorial/Template2.png class=center style=border-radius:8px><p>For the next step, we will import the disk to the VM. Click on the node and navigate to the <code>Shell</code>.</p><p>Head to the directory that you stored the .vmdk earlier and run this command:</p><pre tabindex=0><code># qm importdisk &lt;vmid&gt; &lt;source&gt; &lt;storage&gt; &lt;-- Example
qm importdisk 125 oscp-disk1.vmdk local-lvm
importing disk &#39;oscp-disk1.vmdk&#39; to VM 125 ...
...
</code></pre><p>Once the importing is complete, we can click on the VM that we created, and head to <code>hardware</code>. We should be able to see an unused disk.</p><p>Double click on the unused disk and set it as SCSI. Next is to change the boot under that can be found in the <code>Options</code> tab. Edit the boot order by only checking the scsi0 device</p><img src=/Vulnhub-Tutorial/Template3.png class=center style=border-radius:8px><p>Start the VM. The VM should now boot up and DHCP will give the VM an IP address.</p><img src=/Vulnhub-Tutorial/Template4.png class=center style=border-radius:8px><p><strong>Some vuln machines ip address cannot be seen in the VM. So you either have to scan it manually or check it on your router for the DHCP leasing</strong></p><p>One last thing, once i got my VM machine to work, i will always snapshot it. This will make it easier to revert the machine back to &ldquo;Working State&rdquo; when i finish playing around with it.</p><h3 id=special-case-black-screen-after-booting>Special Case: Black Screen after booting</h3><p>Black Screen upon installation:</p><ul><li>TommyBoy</li><li>Sar</li></ul><p>The machine mentioned above will only show black screen upon booting up when i installed it in my proxmox. I initially thought that i did something wrong. <strong>DO NOT WORRY</strong>. THE MACHINE IS WORKING. JUST VERIFY IT BY EITHER MANUALLY SCANNING THE NETWORK OR CHECK YOUR DHCP LEASE IN THE ROUTER.</p><h3 id=troubleshooting-cannot-boot>Troubleshooting: Cannot Boot</h3><p>All machine that i installed can boot with SCSI except:</p><ul><li>Bravery (iDE)</li><li>Fall (iDE)</li><li>RickdiculouslyEasy (iDE)</li></ul><p>Bravery with SCSI:</p><img src=/Vulnhub-Tutorial/Template5.png class=center style=border-radius:8px><p>Simply detach the drives and then set the drive to IDE. Re-booting the VM will now resolved the issue. This work for the other 2 machine mentioned above.</p><p>Same machine with the drive change to IDE:</p><img src=/Vulnhub-Tutorial/Template6.png class=center style=border-radius:8px><h3 id=troubleshooting-machine-not-recieving-dhcp-ip>Troubleshooting: Machine not recieving DHCP IP</h3><p>Another issue we will come across is when the machine is not recieving IP address.</p><p><strong>0xBEN</strong> here explain very well on how to work this around. You can read it more <a href=https://benheater.com/proxmox-vulnhub-vm-network-interface-issue/>here.</a></p><p>If the machine is using netplan configuration, then follow this examples to resolve the issue: <a href=https://netplan.io/examples/>https://netplan.io/examples/</a></p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://fspxnky.github.io/tags/tutorial/>Tutorial</a></span></p></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.2d3d449fc0ff117f00ac91342a8f76cd5b710411d7a0254dbe75da3234d2f685d6a0c44cff60c414e90b6a149da8e4032c713c25e4e6838e2e3918dc0ad2e81c.js integrity="sha512-LT1En8D/EX8ArJE0Ko92zVtxBBHXoCVNvnXaMjTS9oXWoMRM/2DEFOkLahSdqOQDLHE8JeTmg44uORjcCtLoHA=="></script></body></html>